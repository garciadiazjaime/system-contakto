{% load fe_extras %}
<table align="left" width="100%" cellpadding="3px" cellspacing="3px" style="border: 1px solid black">
	<thead>
		<tr>
			<th class="col-red" colspan="4" style="background-color: indianred;">Datos de Solicitud</th>
			<th class="col-gray" colspan="3" style="background-color: dimgray;">Datos de Candidato</th>
			<th class="col-blue" colspan="3" style="background-color: lightsteelblue;">Resultado</th>
			<th class="col-red" colspan="3" style="background-color: indianred;">Datos de Entrevista</th>
		</tr>
		<tr>
			<th class="col-red" style="background-color: indianred;">Cliente</th>
			<th class="col-red" style="background-color: indianred;">Observaciones</th>
			<th class="col-red" style="background-color: indianred;">Fecha de Recibido</th>
			<th class="col-red" style="background-color: indianred;">Tipo Estudio</th>

			<th class="col-gray" style="background-color: dimgray;">Nombre</th>
			<th class="col-gray" style="background-color: dimgray;">Puesto</th>
			<th class="col-gray" style="background-color: dimgray;">Ciudad y Estado</th>

			<th class="col-blue" style="background-color: lightsteelblue;">Estatus</th>
			<th class="col-blue" style="background-color: lightsteelblue;">Investigación Laboral</th>
			<th class="col-blue" style="background-color: lightsteelblue;">Calificación Final</th>

			<th class="col-red" style="background-color: indianred;">Gestor</th>
			<th class="col-red" style="background-color: indianred;">Día Cita</th>
			<th class="col-red" style="background-color: indianred;">Hora Cita</th>
		</tr>
	</thead>
	<tbody style="border: 1px solid black">
		{% for inv in investigaciones %}
		{% if forloop.counter|divisibleby:2 %}
		<tr style="background-color: #f9f9f9">
		{% else %}
		<tr>
		{% endif %}
			<td>{{ inv.compania.nombre }}</td>
			<td>{{ inv.tipo_investigacion_texto }}</td>
			<td>{{ inv.fecha_recibido|date:"d/M/y" }}</td>
			<td>{{ inv.tipo_investigacion_status|tipo_investigacion_status }}</td>

			<td>{{ inv.candidato.nombre }}</td>
			<td>{{ inv.puesto }}</td>
			<td>{{ inv.ciudad }}, {{ inv.estado }}</td>

			<td>{{ inv.status|investigacion_status|upper }}</td>
			<td class="text-left">
				{% for t in inv.trayectoria %}
					{% if t.puesto_final or t.periodo_alta or t.periodo_baja or t.motivo_salida or t.observaciones_generales or t.opinion_rh or t.opinion_jefe %}
					<table class="estatus-trayectoria table table-striped uppercase">
						<th colspan="2">{{t.compania}}</th>
						{% if t.puesto_final %}
						<tr>
							<td>Puesto</td>
							<td>{{t.puesto_final}}</td>
						</tr>
						{% endif %}
						{% if t.periodo_alta or t.periodo_baja %}
						<tr>
							<td>Periodos</td>
							<td>{{t.periodo_alta|default:""}}-{{t.periodo_baja|default:""}}</td>
						</tr>
						{% endif %}
						{% if t.motivo_salida %}
						<tr>
							<td>Motivo de baja</td>
							<td>{{t.motivo_salida}}</td>
						</tr>
						{% endif %}
						{% if t.observaciones_generales %}
						<tr>
							<td>Observaciones</td>
							<td>{{t.observaciones_generales}}</td>
						</tr>
						{% endif %}

						{% if t.opinion_rh %}
							<tr>
								<td>Referente</td>
								<td>
									{% if t.opinion_rh.nombre %}
									Nombre: <br />
									<b>{{t.opinion_rh.nombre}}</b>
									{% endif %}
									{% if t.opinion_rh.puesto %}
									Puesto: <br />
									<b>{{t.opinion_rh.puesto}}</b>
									{% endif %}
								</td>
							</tr>
						{% endif %}
						{% if t.opinion_jefe %}
							<tr>
								<td>Referente</td>
								<td>
									{% if t.opinion_jefe.nombre %}
									Nombre: <br />
									<b>{{t.opinion_jefe.nombre}}</b>
									{% endif %}
									{% if t.opinion_jefe.puesto %}
									Puesto: <br />
									<b>{{t.opinion_jefe.puesto}}</b>
									{% endif %}
								</td>
							</tr>
						{% endif %}
					</table>
					{% endif %}
				{% endfor %}
			</td>
			<td>{{ inv.resultado|investigacion_resultado }}</td>

			<td>{{inv.entrevista.entrevistador}}</td>
			<td>{{inv.entrevista.fecha_entrevista|default:""}}</td>
			<td>{{inv.entrevista.hora_entrevista|default:""}}</td>
		</tr>
		{% endfor %}
	</tbody>
</table>
